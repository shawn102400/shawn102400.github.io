<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>二进制文件 - 寒冰小站</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="shawn" /><meta name="description" content="二进制文件 [TOC] 所需工具 所需工具 操作系统：Linux : Ubuntu18:http://releases.ubuntu.com/18.04/ 汇编编译器：nasm: https://www.nasm.us/ 虚拟机：vitualbox: [https://www.virtualbox.org/wiki/Linux_Downloads ] 文本编辑器： vscode: https://code.visualstudio.com/ 插件：hexdu" /><meta name="keywords" content="Hugo, theme, even" />






<meta name="generator" content="Hugo 0.92.0 with theme even" />


<link rel="canonical" href="https://blog.shawn1024.fun/post/chap-1.7-%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.b5a744db6de49a86cadafb3b70f555ab443f83c307a483402259e94726b045ff.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="二进制文件" />
<meta property="og:description" content="二进制文件 [TOC] 所需工具 所需工具 操作系统：Linux : Ubuntu18:http://releases.ubuntu.com/18.04/ 汇编编译器：nasm: https://www.nasm.us/ 虚拟机：vitualbox: [https://www.virtualbox.org/wiki/Linux_Downloads ] 文本编辑器： vscode: https://code.visualstudio.com/ 插件：hexdu" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.shawn1024.fun/post/chap-1.7-%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-08-01T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-08-01T00:00:00+00:00" />

<meta itemprop="name" content="二进制文件">
<meta itemprop="description" content="二进制文件 [TOC] 所需工具 所需工具 操作系统：Linux : Ubuntu18:http://releases.ubuntu.com/18.04/ 汇编编译器：nasm: https://www.nasm.us/ 虚拟机：vitualbox: [https://www.virtualbox.org/wiki/Linux_Downloads ] 文本编辑器： vscode: https://code.visualstudio.com/ 插件：hexdu"><meta itemprop="datePublished" content="2021-08-01T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-08-01T00:00:00+00:00" />
<meta itemprop="wordCount" content="1008">
<meta itemprop="keywords" content="操作系统," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="二进制文件"/>
<meta name="twitter:description" content="二进制文件 [TOC] 所需工具 所需工具 操作系统：Linux : Ubuntu18:http://releases.ubuntu.com/18.04/ 汇编编译器：nasm: https://www.nasm.us/ 虚拟机：vitualbox: [https://www.virtualbox.org/wiki/Linux_Downloads ] 文本编辑器： vscode: https://code.visualstudio.com/ 插件：hexdu"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">寒冰小站</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">寒冰小站</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">二进制文件</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-08-01 </span>
        <div class="post-category">
            <a href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"> 操作系统 </a>
            </div>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#二进制文件">二进制文件</a>
          <ul>
            <li><a href="#所需工具">所需工具</a></li>
            <li><a href="#二进制编码表">二进制编码表</a></li>
            <li><a href="#使用汇编生成二进制文件">使用汇编生成二进制文件</a></li>
            <li><a href="#二进制文件分析">二进制文件分析</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h2 id="二进制文件">二进制文件</h2>
<p>[TOC]</p>
<h3 id="所需工具">所需工具</h3>
<p>所需工具</p>
<blockquote>
<p>操作系统：Linux : Ubuntu18:http://releases.ubuntu.com/18.04/</p>
<p>汇编编译器：nasm: <a href="https://www.nasm.us/">https://www.nasm.us/</a></p>
<p>虚拟机：vitualbox:  [https://www.virtualbox.org/wiki/Linux_Downloads ]</p>
<p>文本编辑器：</p>
<ul>
<li>vscode: <a href="https://code.visualstudio.com/">https://code.visualstudio.com/</a></li>
<li>插件：hexdump for vscode</li>
<li>插件：x86 and x86_64 Assembly</li>
<li>插件：<strong>Beautify</strong></li>
</ul>
</blockquote>
<h3 id="二进制编码表">二进制编码表</h3>
<p>英文字符的二进制码（16进制表示）：</p>
<table>
<thead>
<tr>
<th>英文</th>
<th>十六进制</th>
<th>英文</th>
<th>十六进制</th>
<th>英文</th>
<th>十六进制</th>
<th>英文</th>
<th>十六进制</th>
</tr>
</thead>
<tbody>
<tr>
<td>A=65</td>
<td>41</td>
<td>H</td>
<td>48</td>
<td>O</td>
<td>4F</td>
<td>V</td>
<td>56</td>
</tr>
<tr>
<td>B</td>
<td>42</td>
<td>I</td>
<td>49</td>
<td>P</td>
<td>50</td>
<td>W</td>
<td>57</td>
</tr>
<tr>
<td>C</td>
<td>43</td>
<td>J</td>
<td>4A</td>
<td>Q</td>
<td>51</td>
<td>X</td>
<td>58</td>
</tr>
<tr>
<td>D</td>
<td>44</td>
<td>K</td>
<td>4B</td>
<td>R</td>
<td>52</td>
<td>Y</td>
<td>59</td>
</tr>
<tr>
<td>E</td>
<td>45</td>
<td>L</td>
<td>4C</td>
<td>S</td>
<td>53</td>
<td>Z</td>
<td>60</td>
</tr>
<tr>
<td>F</td>
<td>46</td>
<td>M</td>
<td>4D</td>
<td>T</td>
<td>54</td>
<td></td>
<td></td>
</tr>
<tr>
<td>G</td>
<td>47</td>
<td>N</td>
<td>4E</td>
<td>U</td>
<td>55</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="使用汇编生成二进制文件">使用汇编生成二进制文件</h3>
<p>接下来，我们使用汇编语言生成一个二进制文件。这个二进制文件包含一个极其简单的boot引导程序。整个二进制文件可以作为1.44M软盘在虚拟机上运行。</p>
<p>整个程序只做一件事情，就是在屏幕上输出&quot;ratsos&quot;这6个字。</p>
<p><strong>1. 新建汇编文件</strong></p>
<p>新建一个ratsos.asm的文件。打开文本编辑器，写出如下汇编代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">db 0xEB, 0x09, 0x90, 0x52, 0x41, 0x54, 0x53, 0x42 
db 0x4F, 0x4F, 0x54, 0xB8, 0x00, 0xB8, 0x8E, 0xE8   
db 0x65, 0xC6, 0x06, 0x00, 0x00, 0x72, 0x65, 0xC6 
db 0x06, 0x01, 0x00, 0x74, 0x65, 0xC6, 0x06, 0x02    
db 0x00, 0x61, 0x65, 0xC6, 0x06, 0x03, 0x00, 0x74 
db 0x65, 0xC6, 0x06, 0x04, 0x00, 0x74, 0x65, 0xC6  
db 0x06, 0x05, 0x00, 0x74, 0x65, 0xC6, 0x06, 0x06 
db 0x00, 0x73, 0X65, 0xC6, 0x06, 0x07, 0x00, 0x74 
db 0xEB, 0xFE, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
resb 432
db 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x55, 0xAA
db 0xF0, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00, 0x00
resb 4600
db 0xF0, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00, 0x00
resb 1469432
</code></pre></td></tr></table>
</div>
</div><p><strong>2. 编译</strong></p>
<p>在命令行执行</p>
<blockquote>
<p>nasm -f bin -o ratsos.ima ratsos.asm</p>
</blockquote>
<p>编译。编译时有warning。但是不用去管他。</p>
<p>上面的命令将ratsos.asm编译编译成一个二进制文件ratsos.ima。</p>
<p>这个ratsos.ima文件是最基本的二进制bin格式，并且大小为1.44M（1440x1024= 1474560），我们可以将这个ratsos.ima文件直接当做1.44M软盘镜像来使用。</p>
<p><strong>3. 虚拟机运行镜像</strong></p>
<p>使用vitualbox创建一个系统，添加一个软盘驱动器。</p>
<p>使用软盘驱动器加载镜像文件ratsos.ima。</p>
<p><img src="images/1.7.1.png" alt="images/1.7_1.png"></p>
<p>启动系统</p>
<p>输出如下：</p>
<p><img src="images/1.7.2.gif" alt="images/1.7_2.gif"></p>
<h3 id="二进制文件分析">二进制文件分析</h3>
<p>以二进制的方式查看文件内容</p>
<p>使用xxd命令分析二进制文件（以16进制方式输出文件的前512字节）</p>
<blockquote>
<p>xxd -l 512 ratsos.ima</p>
</blockquote>
<p>如图：</p>
<p><img src="images/1.7.3.png" alt="images/1.7_3.png"></p>
<p>其实上面的内容和以下汇编文件生成的内容是一致的</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">;RatsOS
;TAB=4
[bits 16]
	org     0x7c00 				;指明程序的偏移的基地址

;boot程序
	jmp     Entry

;程序核心内容
Entry:
	mov ax,0xb800
	mov gs,ax                   ;显存段地址
	mov byte [gs:0x00],&#39;h&#39;      ;输出字符
	mov byte [gs:0x01],0x74     ;设置颜色(背景色蓝，前景色白)
	mov byte [gs:0x02],&#39;e&#39;
	mov byte [gs:0x03],0x74
	mov byte [gs:0x04],&#39;l&#39;
	mov byte [gs:0x05],0x74
	mov byte [gs:0x06],&#39;l&#39;
	mov byte [gs:0x07],0x74
	mov byte [gs:0x08],&#39;o&#39;

                 	
	jmp $						;进入死循环，不再往下执行。

Fill_Sector:
	resb    510-($-$$)       	;处理当前行$至结束(1FE)的填充
	db      0x55, 0xaa
Fill_Disk:	
	resb    1474560-($-$$)       	;处理当前行$至结束(1440KB)的填充
</code></pre></td></tr></table>
</div>
</div><p>代码地址：</p>
<p><a href="https://github.com/sxt102400/ratsos/tree/master/chapter1.7">https://github.com/sxt102400/ratsos/tree/master/chapter1.7</a></p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">shawn</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        2021-08-01
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/chap-1.2-%E4%B8%BB%E5%BC%95%E5%AF%BC%E6%89%87%E5%8C%BA/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">主引导扇区</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/post/chap-1.5-%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4/">
            <span class="next-text nav-default">汇编指令</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:your@email.com" class="iconfont icon-email" title="email"></a>
      <a href="http://localhost:1313" class="iconfont icon-stack-overflow" title="stack-overflow"></a>
      <a href="http://localhost:1313" class="iconfont icon-twitter" title="twitter"></a>
      <a href="http://localhost:1313" class="iconfont icon-facebook" title="facebook"></a>
      <a href="http://localhost:1313" class="iconfont icon-linkedin" title="linkedin"></a>
      <a href="http://localhost:1313" class="iconfont icon-google" title="google"></a>
      <a href="http://localhost:1313" class="iconfont icon-github" title="github"></a>
      <a href="http://localhost:1313" class="iconfont icon-weibo" title="weibo"></a>
      <a href="http://localhost:1313" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="http://localhost:1313" class="iconfont icon-douban" title="douban"></a>
      <a href="http://localhost:1313" class="iconfont icon-pocket" title="pocket"></a>
      <a href="http://localhost:1313" class="iconfont icon-tumblr" title="tumblr"></a>
      <a href="http://localhost:1313" class="iconfont icon-instagram" title="instagram"></a>
      <a href="http://localhost:1313" class="iconfont icon-gitlab" title="gitlab"></a>
      <a href="http://localhost:1313" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="https://blog.shawn1024.fun/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2017 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span>shawn</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>








</body>
</html>
